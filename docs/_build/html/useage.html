<!doctype html>
<html class="no-js" lang="en" data-content_root="./">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="genindex.html" /><link rel="search" title="Search" href="search.html" /><link rel="next" title="API" href="api.html" /><link rel="prev" title="ENDOGEN" href="index.html" />

    <!-- Generated with Sphinx 7.2.6 and Furo 2023.09.10 -->
        <title>Useage - ENDOGEN 0.01 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?v=135e06be" />
    <link rel="stylesheet" type="text/css" href="_static/tabs.css?v=4c969af8" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?v=36a5483c" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  --color-brand-primary: #00718f;
  --color-brand-content: #00718f;
  --color-background-secondary: #fafafa;
  --color-problematic: #c41230;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  --color-brand-primary: #00718f;
  --color-brand-content: #00718f;
  --color-problematic: #e87722;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  --color-brand-primary: #00718f;
  --color-brand-content: #00718f;
  --color-problematic: #e87722;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">ENDOGEN 0.01 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="index.html">
  
  
  <span class="sidebar-brand-text">ENDOGEN 0.01 documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Useage</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html">API</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="useage">
<h1>Useage<a class="headerlink" href="#useage" title="Link to this heading">#</a></h1>
<p>Simulation of a system of interdependent models comes at the cost of needing extensive setup and configuration. There is not just one model to specify, there are N models to specify. Moreover, they must match in the specific sense that the <em>transformation</em> step and the <em>forecast</em> step are each directed acyclic graphs (DAGs), whilst the combination of these two steps must result in a perfect circle with no hanging variables.</p>
<p>ENDOGEN solves this through setting up the data models through extensive configuration schemas, with the option to write and store configuration in YAML and load with <a class="reference external" href="https://hydra.cc/">hydra</a>. The model controler in ENDOGEN also automatically solves sequencing of interdependent calculations by putting everything into a <a class="reference external" href="https://networkx.org/">NetworkX</a> modeling graph, and solving the two steps of the graph using <code class="docutils literal notranslate"><span class="pre">networkx.topological_generations</span></code>.</p>
<p>The flowcharts below show an example of how this might look like.</p>
<div class="mermaid">
            flowchart
    transformation-- t+1 --&gt;forecast
    forecast--&gt;transformation
        </div><div class="mermaid">
            flowchart
    subgraph Transformation
    var1 -- rolling_mean3 --&gt; var1_rm3
    var1_rm3 -- lag1 --&gt; var1_rm3_l1
    var1 -- lag1 --&gt; var1_l1
    var2 -- growth --&gt; var2_gr
    var2_gr -- lag1 --&gt; var2_gr_l1
    var2 -- lag1 --&gt; var2_l1
    end
        </div><div class="mermaid">
            flowchart
    subgraph Forecast
    var1_l1 -- predict --&gt; var1
    var1_rm3_l1 -- predict --&gt; var1
    var2_gr_l1 -- predict --&gt; var1
    var1_l1 -- predict --&gt; var2
    var2_l1 -- predict --&gt; var2
    end
        </div><p>ENDOGEN is using a fixed naming scheme for variable transformations:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>{base}_{suffix}{number} 
</pre></div>
</div>
<p>Multiple suffixes can be added with additional underscores, as shown in the example flowcharts above. See <a class="reference internal" href="api.html#endogen.config.Lags" title="endogen.config.Lags"><code class="xref py py-func docutils literal notranslate"><span class="pre">endogen.config.Lags()</span></code></a> and <a class="reference internal" href="api.html#endogen.config.Rolling" title="endogen.config.Rolling"><code class="xref py py-func docutils literal notranslate"><span class="pre">endogen.config.Rolling()</span></code></a>.</p>
<p>The exception to this rule are <a class="reference internal" href="api.html#endogen.config.Transform" title="endogen.config.Transform"><code class="xref py py-func docutils literal notranslate"><span class="pre">endogen.config.Transform()</span></code></a>, since these are built from arbitrary functions. Here, the user must specify an <code class="docutils literal notranslate"><span class="pre">output_var</span></code> as name.</p>
<section id="using-configuration-files">
<h2>Using configuration files<a class="headerlink" href="#using-configuration-files" title="Link to this heading">#</a></h2>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>.
├──<span class="w"> </span>config.yaml
├──<span class="w"> </span>global_config
│<span class="w">   </span>└──<span class="w"> </span>simple_run.yaml
└──<span class="w"> </span>variables
<span class="w">    </span>├──<span class="w"> </span>growth_v1.yaml
<span class="w">    </span>├──<span class="w"> </span>intensity_level_v1.yaml
<span class="w">    </span>├──<span class="w"> </span>population_v1.yaml
<span class="w">    </span>└──<span class="w"> </span>v2x_libdem_v1.yaml
</pre></div>
</div>
<p>When using .yaml configuration in ENDOGEN, you will have to create a configuration folder that looks like the above, with “global_config” and “variables” sub-folders, and a “config.yaml” in the root. The configuration can be loaded using the following code:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">hydra.utils</span> <span class="kn">import</span> <span class="n">instantiate</span>
<span class="kn">import</span> <span class="nn">hydra</span>

<span class="k">with</span> <span class="n">hydra</span><span class="o">.</span><span class="n">initialize</span><span class="p">(</span><span class="n">version_base</span> <span class="o">=</span> <span class="s2">&quot;1.3&quot;</span><span class="p">,</span> <span class="n">config_path</span><span class="o">=</span><span class="s2">&quot;conf&quot;</span><span class="p">):</span>
    <span class="n">config</span> <span class="o">=</span> <span class="n">hydra</span><span class="o">.</span><span class="n">compose</span><span class="p">(</span><span class="n">config_name</span> <span class="o">=</span> <span class="s2">&quot;config&quot;</span><span class="p">)</span>
    <span class="n">config</span> <span class="o">=</span> <span class="n">instantiate</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="n">_convert_</span><span class="o">=</span><span class="s2">&quot;all&quot;</span><span class="p">)</span>

<span class="n">config</span><span class="o">.</span><span class="n">global_config</span>
<span class="n">config</span><span class="o">.</span><span class="n">variables</span>
</pre></div>
</div>
<p>Here, <code class="docutils literal notranslate"><span class="pre">config_path</span></code> is the path to the config folder, in this case named “conf”. The <code class="docutils literal notranslate"><span class="pre">config_name</span></code> is the name of the main/root config file “config.yaml”.</p>
<section id="config-yaml">
<h3>config.yaml<a class="headerlink" href="#config-yaml" title="Link to this heading">#</a></h3>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">defaults</span><span class="p">:</span>
<span class="w">   </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">global_config</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">simple_run</span>
<span class="w">   </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">variables@_variable_dict.growth</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">growth_v1</span>
<span class="w">   </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">variables@_variable_dict.intensity_level</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">intensity_level_v1</span>
<span class="w">   </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">variables@_variable_dict.v2x_libdem</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v2x_libdem_v1</span>
<span class="w">   </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">variables@_variable_dict.psecprop</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">psecprop_v1</span>
<span class="w">   </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">variables@_variable_dict.population</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">population_v1</span>
<span class="w">   </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">_self_</span>
<span class="w">   </span>
<span class="nt">_target_</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">endogen.config.Config</span><span class="w">   </span>
<span class="nt">variables</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${oc.dict.values:_variable_dict}</span>
</pre></div>
</div>
<p>We see that the <code class="docutils literal notranslate"><span class="pre">\_target\_</span></code> of the “config.yaml” file is <a class="reference internal" href="api.html#endogen.config.Config" title="endogen.config.Config"><code class="xref py py-func docutils literal notranslate"><span class="pre">endogen.config.Config()</span></code></a>, and it must comply with the schema of this python class. <code class="docutils literal notranslate"><span class="pre">Config</span></code> takes a <a class="reference internal" href="api.html#endogen.config.GlobalSimConfig" title="endogen.config.GlobalSimConfig"><code class="xref py py-func docutils literal notranslate"><span class="pre">endogen.config.GlobalSimConfig()</span></code></a> and a list of <a class="reference internal" href="api.html#endogen.config.InputModel" title="endogen.config.InputModel"><code class="xref py py-func docutils literal notranslate"><span class="pre">endogen.config.InputModel()</span></code></a> as input.</p>
<p>The “config.yaml” in the root folder must look something like what you see above, with each InputModel linked using this rather offputting syntax (that hopefully will be improved in later versions of hydra, see <a class="reference external" href="https://github.com/facebookresearch/hydra/issues/1939">here</a> and <a class="reference external" href="https://stackoverflow.com/questions/71052174/using-multiple-configs-in-the-same-group-to-interpolate-values-in-a-yaml-file">here</a>). The important thing here is that the strings after the colons refer to stems of file names inside the “global_config” and “variables” folders, respectively. If you want to add a InputModel, you can add a new “- variables&#64;_variable_dict.{var_name}: {file_stem}” entry.</p>
</section>
<section id="global-configuration">
<h3>Global configuration<a class="headerlink" href="#global-configuration" title="Link to this heading">#</a></h3>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">_target_</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">endogen.config.GlobalSimConfig</span>
<span class="nt">input_data</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">data/cy_data_static_test.csv</span>
<span class="nt">time_var</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">year</span>
<span class="nt">unit_var</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gwcode</span>
<span class="nt">nsim</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10</span>
<span class="nt">end</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2030</span>
<span class="nt">include_past_n</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5</span>
<span class="nt">vars</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">grwth</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">gdppc</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">population</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">psecprop</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">intensity_level</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">v2x_libdem</span><span class="p p-Indicator">]</span>
</pre></div>
</div>
<p>“simple_run.yaml” is residing in the “global_config” subfolder, and has <a class="reference internal" href="api.html#endogen.config.GlobalSimConfig" title="endogen.config.GlobalSimConfig"><code class="xref py py-func docutils literal notranslate"><span class="pre">endogen.config.GlobalSimConfig()</span></code></a> as<code class="docutils literal notranslate"><span class="pre">\_target\_</span></code>.</p>
<p>Here, the path (relative to the current working directory or absolute) to the input_data, the names of panel data dimensions, number of simulations, when to end simulations, how much past data to include when fitting models, and the variables to include from the input_data can be set up.</p>
</section>
<section id="variables-inputmodel">
<h3>Variables (InputModel)<a class="headerlink" href="#variables-inputmodel" title="Link to this heading">#</a></h3>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">_target_</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">endogen.config.InputModel</span>
<span class="nt">stage</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">writing</span>
<span class="nt">output_var</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">grwth</span>
<span class="nt">input_vars</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">gdppc_l1</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">grwth_rm4_l1</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">intensity_level_hlm8_l1</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">psecprop_l1</span><span class="p p-Indicator">]</span>
<span class="nt">model</span><span class="p">:</span><span class="w"> </span>
<span class="w">  </span><span class="nt">_target_ </span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mlforecast.MLForecast</span>
<span class="w">  </span><span class="nt">models</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">_target_</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">sklearn.linear_model.LinearRegression</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">_target_</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">sklearn.ensemble.RandomForestRegressor</span>
<span class="w">  </span><span class="nt">freq</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">  </span><span class="nt">num_threads</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">4</span>
<span class="nt">lags</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">_target_</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">endogen.config.Lags</span>
<span class="w">    </span><span class="nt">num_lag</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">    </span><span class="nt">input_vars</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">gdppc</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">grwth_rm4</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">intensity_level_hlm8</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">psecprop</span><span class="p p-Indicator">]</span>
<span class="nt">rolling</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">_target_</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">endogen.config.Rolling</span>
<span class="w">    </span><span class="nt">window</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">4</span>
<span class="w">    </span><span class="nt">funs</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">mean</span><span class="p p-Indicator">]</span>
<span class="w">    </span><span class="nt">input_vars</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">grwth</span><span class="p p-Indicator">]</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">_target_</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">endogen.config.Rolling</span>
<span class="w">    </span><span class="nt">window</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8</span>
<span class="w">    </span><span class="nt">window_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">halflife</span>
<span class="w">    </span><span class="nt">funs</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">mean</span><span class="p p-Indicator">]</span>
<span class="w">    </span><span class="nt">input_vars</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">intensity_level</span><span class="p p-Indicator">]</span>
<span class="nt">transforms</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">_target_</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">endogen.config.Transform</span>
<span class="w">    </span><span class="nt">output_var</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gdppc</span>
<span class="w">    </span><span class="nt">input_vars</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">gdppc_l1</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">grwth</span><span class="p p-Indicator">]</span>
<span class="w">    </span><span class="nt">formula</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">np.add(gdppc_l1, gdppc_l1*grwth)</span>
<span class="w">    </span><span class="nt">after_forecast</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">True</span><span class="w"> </span>
</pre></div>
</div>
<p>The <a class="reference internal" href="api.html#endogen.config.InputModel" title="endogen.config.InputModel"><code class="xref py py-func docutils literal notranslate"><span class="pre">endogen.config.InputModel()</span></code></a> is the way to define a statistical variable model in ENDOGEN.</p>
<p>The above example shows how the configuration .yaml file for one variable “grwth” might look like. The “_target_” refers to a Python class that will be instantiated by <code class="docutils literal notranslate"><span class="pre">hydra</span></code> when loading the configuration. We can see that this configuration file is targeting the <a class="reference internal" href="api.html#endogen.config.InputModel" title="endogen.config.InputModel"><code class="xref py py-func docutils literal notranslate"><span class="pre">endogen.config.InputModel()</span></code></a> class, and must follow the schema of that class to be valid.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">output_var</span></code> is the name of the variable, and should be found for past observations in the <code class="docutils literal notranslate"><span class="pre">input_data</span></code> that is set in <a class="reference internal" href="api.html#endogen.config.GlobalSimConfig" title="endogen.config.GlobalSimConfig"><code class="xref py py-func docutils literal notranslate"><span class="pre">endogen.config.GlobalSimConfig()</span></code></a>.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">input_vars</span></code> is a list of input variables to the statistical model used to fit and predict <code class="docutils literal notranslate"><span class="pre">output_var</span></code>. These must all be 1 time-unit lags. They must also either be fully defined as transformations taking the <code class="docutils literal notranslate"><span class="pre">output_var</span></code> as input, or taking other output variables defined in other <a class="reference internal" href="api.html#endogen.config.InputModel" title="endogen.config.InputModel"><code class="xref py py-func docutils literal notranslate"><span class="pre">endogen.config.InputModel()</span></code></a> as input, or a combination of the two.</p>
<p>In the above example, “grwth” rely on two other InputModels: “intensity_level” and “psecprop”. It also rely on “gddpc” being included in <code class="docutils literal notranslate"><span class="pre">input_data</span></code>. However, given an initial value, you can see that “gdppc” is calculated as a function of “gdppc_l1” and “grwth”. This particular tranformation is done in the forecast step, after the forecast, instead of in the transformation step, as it needs the currently estimated “grwth” in its calculation.</p>
<p>In the transformation step, the lags and rolling variables, as well as any transforms where <code class="docutils literal notranslate"><span class="pre">after_forecast</span></code> is False, are calculated. The transformations must be possible to describe as directed acyclic graphs (DAGs). In the above example, “intensity_level” is used to calculate the rolling mean 8-year half-life, “intensity_level_hlm8”. Note that the output variable name is implicitly given by the fixed naming scheme. “intensity_level_hlm8” then becomes input to calculating the 1-year lagged variable “intensity_level_hlm8_l1”.</p>
<p>The model used in this example is a <a class="reference external" href="https://github.com/Nixtla/mlforecast">mlforecast</a> model defined as an equally weighted ensemble of two <a class="reference external" href="https://scikit-learn.org/stable/index.html">scikit-learn</a> models, a linear (OLS) model and a random forest, both with default specifications. As we are using an integer based time-variable, <code class="docutils literal notranslate"><span class="pre">freq</span></code> must be 1 (each step increase the year with 1). ENDOGEN will fit these models with conformal prediction, asking for ten different prediction intervals, building a 0.05-percentile stepwise histogram across the complete predictive distribution. When making forecasts, the model will then draw randomly from this distribution for each prediction (at each time-step, for each unit, for each independent simulation run).</p>
</section>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="api.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">API</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="index.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Home</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2023, PRIO
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Useage</a><ul>
<li><a class="reference internal" href="#using-configuration-files">Using configuration files</a><ul>
<li><a class="reference internal" href="#config-yaml">config.yaml</a></li>
<li><a class="reference internal" href="#global-configuration">Global configuration</a></li>
<li><a class="reference internal" href="#variables-inputmodel">Variables (InputModel)</a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="_static/documentation_options.js?v=6ca3c713"></script>
    <script src="_static/doctools.js?v=888ff710"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/scripts/furo.js?v=32e29ea5"></script>
    <script src="_static/tabs.js?v=3ee01567"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=5d53a5da"></script>
    <script src="https://unpkg.com/mermaid@10.2.0/dist/mermaid.min.js"></script>
    <script>mermaid.initialize({startOnLoad:true});</script>
    </body>
</html>